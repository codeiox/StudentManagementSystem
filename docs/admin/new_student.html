<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>New Student Registration</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  .form-container {
    max-width: 500px;
  }
</style>

</head>
<link rel="stylesheet" href="assets/sidebar.css">

<body>
  <div id="sidebar-container"></div>

  <div class="main">
    <h1>Register New Student</h1>

    <form id="studentForm" class="form-container mt-4">
      <div class="mb-3">
        <label class="form-label">First Name</label>
        <input type="text" name="firstName" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Last Name</label>
        <input type="text" name="lastName" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Date of Birth</label>
        <input type="date" name="dateofbirth" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Email</label>
        <input type="email" name="email" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Phone</label>
        <input type="text" name="phone" class="form-control" required>
      </div>

      <div class="mb-3">
        <label class="form-label">Address</label>
        <textarea name="address" class="form-control" required></textarea>
      </div>

      <div class="mb-3">
        <label class="form-label">Sex</label>
        <select name="sex" class="form-select" required>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Student ID</label>
        <input type="text" name="studentId" class="form-control" required>
      </div>
       <div class="mb-3">
        <label class="form-label">Username</label>
        <input type="text" name="username" class="form-control" required>
      </div>
       <div class="mb-3">
        <label class="form-label">Password</label>
        <input type="password" name="password" class="form-control" required>
      </div>

      <button type="submit" class="btn btn-success">Create Student</button>
      <button type="button" class="btn btn-secondary ms-2" onclick="window.location.href='/admin/dashboard.html'">Back</button>
    </form>

    <p id="status" class="mt-3"></p>

    <div id="actions" class="mt-3" style="display:none;">
      <button id="backBtn" class="btn btn-secondary">Back to Dashboard</button>
      <button id="registerBtn" class="btn btn-primary">Register Another Student</button>
    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById('studentForm');
  const actions = document.getElementById('actions');
  const status = document.getElementById('status');
  const backBtn = document.getElementById('backBtn');
  const registerBtn = document.getElementById('registerBtn');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const data = {
      //name: form.firstName.value + ' ' + form.lastName.value,
      firstName: form.firstName.value,
      lastName: form.lastName.value,
      dateofbirth: form.dateofbirth.value,
      phone: form.phone.value,
      email: form.email.value,
      address: form.address.value,
      sex: form.sex.value,
      studentId: form.studentId.value,
      username: form.username.value,
      password: form.password.value
    };

    try {
      const res = await fetch('/api/admin/students', { 
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
      });

      if (res.ok) {
        status.textContent = "✅ Student created successfully!";
        status.style.color = "green";
        form.style.display = "none";
        actions.style.display = "block";
        backBtn.onclick = () => window.location.href = '/admin/dashboard.html';
        registerBtn.onclick = () => window.location.reload();
      } else {
        const text = await res.text();
        status.textContent = "❌ Error: " + text;
        status.style.color = "red";
      }
    } catch (err) {
      status.textContent = "❌ Error: " + err.message;
      status.style.color = "red";
    }
  });
});
</script>

<script src="assets/sidebar.js"></script>

</body>
</html>
